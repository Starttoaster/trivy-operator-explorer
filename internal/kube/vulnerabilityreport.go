package kube

import (
	"context"

	"github.com/aquasecurity/trivy-operator/pkg/apis/aquasecurity/v1alpha1"
)

const vulnerabilityReportsResource = "vulnerabilityreports"

// GetVulnerabilityReportList retrieves all resources of type vulnerabilityreports in all namespaces.
func GetVulnerabilityReportList() (*v1alpha1.VulnerabilityReportList, error) {
	var vulnList v1alpha1.VulnerabilityReportList
	err := client.
		Get().
		Resource(vulnerabilityReportsResource).
		Do(context.TODO()).
		Into(&vulnList)
	if err != nil {
		return nil, err
	}

	return &vulnList, nil
}
